<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Тест: Трудовое право</title>

  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">

</head>

<body>

  <h1>Тест по теме «Трудовое право»</h1>

  <div class="mode-wrap">
    <label style="font-size:18px;font-weight:600;">
      <input type="checkbox" id="examModeToggle" style="transform:scale(1.25);margin-right:8px;vertical-align:middle;">
      Режим «Экзамен»
    </label>
  </div>

  <div id="progress"></div>
  <div id="quiz-container"></div>

  <div style="max-width:600px;margin:12px auto 0;">
    <button id="nextBtn" onclick="startTest()">Начать</button>
  </div>

<script>
const questions = [
  {
    text: "Что такое трудовое право? (выберите один или несколько вариантов)",
    options: [
      "Отрасль права, регулирующая трудовые отношения",
      "Совокупность норм, регулирующих семейные отношения",
      "Раздел гражданского права",
      "Система норм, регулирующих только трудовые споры"
    ],
    correct: [0]
  },
  {
    text: "Что относится к предмету трудового права? (выберите один или несколько вариантов)",
    options: [
      "Трудовые отношения между работником и нанимателем",
      "Отношения по найму жилого помещения",
      "Социально-трудовые отношения, связанные с занятостью",
      "Отношения по наследованию имущества"
    ],
    correct: [0, 2]
  },
  {
    text: "Кто является субъектом трудового права? (выберите один или несколько вариантов)",
    options: [
      "Работники",
      "Наниматели",
      "Органы по труду и соцзащите",
      "Налоговая инспекция"
    ],
    correct: [0, 1, 2]
  },
  {
    text: "Что такое Трудовой кодекс Республики Беларусь? (выберите один или несколько вариантов)",
    options: [
      "Основной нормативный акт, регулирующий трудовые отношения",
      "Справочник для кадровика",
      "Документ, регулирующий семейные отношения",
      "Кодекс, устанавливающий права и обязанности работников и нанимателей"
    ],
    correct: [0, 3]
  },
  {
    text: "Что такое трудовой договор? (выберите один или несколько вариантов)",
    options: [
      "Соглашение между работником и нанимателем о трудовой деятельности",
      "Документ о разовой покупке товара",
      "Соглашение, устанавливающее условия труда",
      "Договор о передаче имущества в собственность"
    ],
    correct: [0, 2]
  },
  {
    text: "Какие условия входят в трудовой договор? (выберите один или несколько вариантов)",
    options: [
      "Место работы",
      "Наименование должности",
      "Размер зарплаты",
      "Количество комнат в квартире работника"
    ],
    correct: [0, 1, 2]
  },
  {
    text: "Какие существуют виды трудовых договоров? (выберите один или несколько вариантов)",
    options: [
      "Бессрочный трудовой договор",
      "Срочный трудовой договор",
      "Контракт",
      "Договор купли-продажи"
    ],
    correct: [0, 1, 2]
  },
  {
    text: "Что такое предварительное испытание при приёме на работу? (выберите один или несколько вариантов)",
    options: [
      "Проверка соответствия работника поручаемой работе",
      "Форма наказания работника",
      "Основание для отказа нанимателя без объяснений",
      "Испытание, назначаемое только по желанию работника"
    ],
    correct: [0]
  },
  {
    text: "Кому нельзя устанавливать испытательный срок? (выберите один или несколько вариантов)",
    options: [
      "Несовершеннолетним",
      "Беременным женщинам",
      "Работникам по переводу",
      "Всем, кто работает по контракту"
    ],
    correct: [0, 1, 2]
  },
  {
    text: "Какие элементы входят в содержание трудовых отношений? (выберите один или несколько вариантов)",
    options: [
      "Выполнение работником трудовой функции",
      "Обеспечение нанимателем условий труда",
      "Предоставление жилья нанимателем",
      "Подчинение правилам внутреннего распорядка"
    ],
    correct: [0, 1, 3]
  },

  {
    text: "Какие документы необходимы для заключения трудового договора? (выберите один или несколько вариантов)",
    options: [
      "Паспорт",
      "Трудовая книжка (если есть)",
      "Автобиография",
      "Документ об образовании — при необходимости"
    ],
    correct: [0, 1, 3]
  },
  {
    text: "Какие гарантии предусмотрены Трудовым кодексом? (выберите один или несколько вариантов)",
    options: [
      "Право на отпуск",
      "Право на безопасные условия труда",
      "Право на бесплатное питание",
      "Право на оплату труда не ниже минимальной"
    ],
    correct: [0, 1, 3]
  },
  {
    text: "Что относится к обязанностям работника? (выберите один или несколько вариантов)",
    options: [
      "Соблюдение трудовой дисциплины",
      "Качественное выполнение работы",
      "Соблюдение правил охраны труда",
      "Назначение заработной платы самому себе"
    ],
    correct: [0, 1, 2]
  },
  {
    text: "Что относится к обязанностям нанимателя? (выберите один или несколько вариантов)",
    options: [
      "Обеспечить безопасные условия труда",
      "Выплачивать заработную плату вовремя",
      "Предоставлять отпуск",
      "Оплачивать все личные расходы работника"
    ],
    correct: [0, 1, 2]
  },
  {
    text: "Когда трудовой договор считается заключённым? (выберите один или несколько вариантов)",
    options: [
      "После подписания сторонами",
      "После допуска к работе",
      "После прохождения испытания",
      "После регистрации в налоговой"
    ],
    correct: [0, 1]
  },

  /* Можно добавить похожие вопросы: */

  {
    text: "Что включает понятие трудовой функции работника? (выберите один или несколько вариантов)",
    options: [
      "Должность или профессия",
      "Конкретные обязанности",
      "Перечень трудовых прав работника",
      "Квалификационные требования"
    ],
    correct: [0, 1, 3]
  },
  {
    text: "Что относится к основным правам работника? (выберите один или несколько вариантов)",
    options: [
      "Право на оплату труда",
      "Право на безопасные условия",
      "Право на отпуск",
      "Право увольнять нанимателя"
    ],
    correct: [0, 1, 2]
  },
  {
    text: "Что относится к основным правам нанимателя? (выберите один или несколько вариантов)",
    options: [
      "Требовать соблюдения трудовой дисциплины",
      "Поощрять работников",
      "Применять меры взыскания",
      "Отменять трудовые законы"
    ],
    correct: [0, 1, 2]
  },
  {
    text: "Что может быть основанием для прекращения трудового договора? (выберите один или несколько вариантов)",
    options: [
      "Соглашение сторон",
      "Истечение срока",
      "Личное желание работника",
      "Нарушение дисциплины"
    ],
    correct: [0, 1, 2, 3]
  },
  {
    text: "Какие документы оформляются при приёме на работу? (выберите один или несколько вариантов)",
    options: [
      "Приказ о приёме",
      "Трудовой договор",
      "График отпусков",
      "Личная карточка работника"
    ],
    correct: [0, 1, 3]
  }
];


/* -------- STATE -------- */
let examMode = false;
let shuffled = [];
let current = 0;
let score = 0;
let answerShown = false;

/* Shuffle array */
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

document.getElementById('examModeToggle').addEventListener('change', e => {
  examMode = e.target.checked;
});

/* -------- START -------- */
function startTest() {
  shuffled = shuffle([...questions]);
  current = 0;
  score = 0;
  answerShown = false;
  loadQuestion();
}

/* -------- LOAD QUESTION -------- */
function loadQuestion() {
  const container = document.getElementById('quiz-container');
  const progress = document.getElementById('progress');
  const nextBtn = document.getElementById('nextBtn');

  progress.innerText = `Вопрос ${current + 1} из ${shuffled.length}`;
  const q = shuffled[current];

  const opts = q.options.map((opt, i) => ({ opt, i }));
  shuffle(opts);
  q.shuffledOpts = opts;
  q.correctShuffled = opts.findIndex(o => o.i === q.correct);

  container.innerHTML = `
    <div class="card">
      <p><strong>${escapeHtml(q.text)}</strong></p>
      ${opts.map((o, i) => `
        <label style="display:block;line-height:1.5;margin:6px 0;">
          <input type="radio" name="q${current}" value="${i}">
          ${escapeHtml(o.opt)}
        </label>
      `).join('')}
      <div class="answer-box" id="answerBox"></div>
    </div>
  `;

  const answerBox = document.getElementById('answerBox');
  answerBox.style.display = 'none';

  if (examMode) {
    nextBtn.innerText = 'Далее';
    nextBtn.onclick = submitExamAnswer;
  } else {
    nextBtn.innerText = 'Показать ответ';
    nextBtn.onclick = showAnswer;
  }

  answerShown = false;
}

/* -------- STUDY MODE -------- */
function showAnswer() {
  const q = shuffled[current];
  const selectedEl = document.querySelector(`input[name=q${current}]:checked`);

  if (!selectedEl) return alert('Выберите вариант ответа!');

  const selected = parseInt(selectedEl.value);
  const answerBox = document.getElementById('answerBox');
  const nextBtn = document.getElementById('nextBtn');

  if (selected === q.correctShuffled) score++;

  answerBox.style.display = 'block';

  if (selected === q.correctShuffled) {
    answerBox.innerHTML = '<span class="correct">Верно!</span>';
  } else {
    answerBox.innerHTML = `
      <span class="wrong">Неверно.</span><br>
      Правильный ответ: <strong>${escapeHtml(q.shuffledOpts[q.correctShuffled].opt)}</strong>
    `;
  }

  nextBtn.innerText = (current + 1 === shuffled.length) ? 'Завершить' : 'Далее';
  nextBtn.onclick = nextQuestion;

  answerShown = true;
}

/* -------- EXAM MODE -------- */
function submitExamAnswer() {
  const q = shuffled[current];
  const selectedEl = document.querySelector(`input[name=q${current}]:checked`);

  if (!selectedEl) return alert('Выберите вариант ответа!');

  const selected = parseInt(selectedEl.value);
  if (selected === q.correctShuffled) score++;

  answerShown = true;
  nextQuestion();
}

/* -------- NEXT -------- */
function nextQuestion() {
  if (!answerShown) return;
  current++;
  if (current >= shuffled.length) return finish();
  loadQuestion();
}

/* -------- FINISH -------- */
function finish() {
  const container = document.getElementById('quiz-container');
  const nextBtn = document.getElementById('nextBtn');
  const progress = document.getElementById('progress');

  progress.innerText = '';

  container.innerHTML = `
    <div class="card" style="text-align:center;">
      <h2>Тест завершён!</h2>
      <p>Ваш результат:</p>
      <h1>${score} / ${shuffled.length}</h1>
    </div>
  `;

  nextBtn.innerText = 'Пройти заново';
  nextBtn.onclick = startTest;
}

/* HTML escape */
function escapeHtml(str) {
  return String(str)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#039;');
}
</script>

<!-- Register service worker -->
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/Test-TrudovoePravo/sw.js")
    .then(() => console.log("SW registered"))
    .catch(err => console.error("SW registration failed", err));
}
</script>

</body>
</html>
